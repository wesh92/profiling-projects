kubectl delete -f python/python-job.yaml --ignore-not-found && kubectl apply -f python/python-job.yaml

docker build -f ./python/python.dockerfile -t python-logger-app:latest . && docker save python-logger-app:latest -o python/python-logger-app.tar && sudo k3s ctr image import python/python-logger-app.tar && kubectl delete -f python/python-job.yaml --ignore-not-found && kubectl apply -f python/python-job.yaml

kubectl -n kubernetes-dashboard create token admin-user

helm upgrade --install vector-b vector/vector -n vector -f vector/vector-values.yaml


# grafana password
kubectl get secret --namespace lgtm lgtm-grafana -o jsonpath="{.data.admin-password}" | base64 --decode ; echo

# grafana updates
helm upgrade --install grafana-agent grafana-agent -f grafana/grafana-agent-values.yaml --repo https://grafana.github.io/helm-charts


# forwards
nohup kubectl port-forward --namespace lgtm service/lgtm-grafana 8080:80 &

nohup kubectl -n kubernetes-dashboard port-forward svc/kubernetes-dashboard-kong-proxy 8443:443 &


# build docker image
docker build -f ./python/python.dockerfile -t python-logger-app:latest .
